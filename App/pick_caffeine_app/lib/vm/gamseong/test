// ë‚´ ì •ë³´ ìˆ˜ì • í˜ì´ì§€
/*
// ----------------------------------------------------------------- //
  - title         : Update Account Page
  - Description   :
  - Author        : Gam Sung
  - Created Date  : 2025.06.05
  - Last Modified : 2025.06.05
  - package       :

// ----------------------------------------------------------------- //
  [Changelog]
  - 2025.06.05 v1.0.0  :
// ----------------------------------------------------------------- //
*/
import 'package:flutter/material.dart';
import 'package:get/get.dart';
import 'package:pick_caffeine_app/app_colors.dart';
import 'package:pick_caffeine_app/vm/gamseong/vm_store_update.dart';
import 'package:pick_caffeine_app/widget_class/utility/button_light_brown.dart';
import 'package:pick_caffeine_app/widget_class/utility/custom_text_field.dart';
class CustomerUpdateAccount extends StatelessWidget {
  CustomerUpdateAccount({super.key});

  final vm = Get.put(Vmgamseong());

  final nicknamecontroller = TextEditingController();
  final idcontroller = TextEditingController();
  final pwcontroller = TextEditingController();
  final checkpwcontroller = TextEditingController();
  final phonecontroller = TextEditingController();
  final emailcontroller = TextEditingController();
  

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: Obx(() => 
      Center(
        child: Column(
          children: [
            Container(
              height: 200,
              width: 200,
            ),
            CustomTextField(
              label: 'ë‹‰ë„¤ì„', 
              controller: nicknamecontroller),
              SizedBox(height: 10,),
              ButtonLightBrown(
                text: 'ë‹‰ë„¤ì„ ì¤‘ë³µí™•ì¸', onPressed: () async {
                  if (nicknamecontroller.text.trim().isEmpty) {
                  Get.snackbar('ì˜¤ë¥˜ ë°œìƒ', 'ê°’ì„ ì…ë ¥ í•œ ë’¤ í™•ì¸ í•´ì£¼ì„¸ìš”.', backgroundColor: AppColors.red, colorText: AppColors.white);
                }else{
                  await vm.usernicknamecheck(nicknamecontroller.text.trim().toString());
                  vm.nicknameCheck.value == 0
                  ? _shownicknameDialogue('ë‹‰ë„¤ì„', nicknamecontroller.text.trim())
                  : Get.snackbar('ë‹‰ë„¤ì„ ì¤‘ë³µ', 'ë‹¤ë¥¸ ë‹‰ë„¤ì„ë¥¼ ì´ìš© í•´ì£¼ì„¸ìš”.');
                }
              },),
              SizedBox(height: 30),
              CustomTextField(label: "ë¹„ë°€ë²ˆí˜¸ë¥¼ì…ë ¥í•´ì£¼ì„¸ìš”", controller: pwcontroller),
              
              SizedBox(height: 30),
              CustomTextField(label: "ë¹„ë°€ë²ˆí˜¸ë¥¼í™•ì•ˆí•´ì£¼ì„¸ìš”", controller: checkpwcontroller),
              SizedBox(height: 10,),
              ButtonLightBrown(text: "ë¹„ë°€ë²ˆí˜¸í™•ì¸", onPressed: () async{
                if(pwcontroller.text.trim() == checkpwcontroller.text.trim()){
                  Get.snackbar("ì„±ê³µ", "ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•©ë‹ˆë‹¤.",backgroundColor: AppColors.red, colorText: AppColors.white);

                }else{
                  Get.snackbar("ë¶ˆì¼ì¹˜", "ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.", backgroundColor: AppColors.red, colorText: AppColors.white);
                  
                }
              },)

          ],
        ),

      )  
      )

    );
    

    
  }

_shownicknameDialogue(String type,String input){
  Get.defaultDialog(
    title: 'í™•ì¸ ì™„ë£Œ',
    middleText: 
    '''
    ì…ë ¥ëœ $type : $input ì…ë‹ˆë‹¤.
    ì…ë ¥í•˜ì‹  ê°’ì„ ì‚¬ìš© í•˜ì‹œê² ìŠµë‹ˆê¹Œ?
    ''',
    actions: [
      TextButton(
        onPressed: () => Get.back(), 
        child: Text('ëŒì•„ê°€ê¸°',style: TextStyle(color: AppColors.brown))
      ),
      TextButton(
        onPressed: () {
          vm.nickReadOnly.value = true;
          Get.back();
        }, 
        child: Text('ì‚¬ìš©í•˜ê¸°',style: TextStyle(color: AppColors.brown))
      ),
    ]
  );
}

}
///////---------------------ì»¤ìŠ¤í…€ ì—…ë°ì´íŠ¸ ì–´ì¹´ìš´íŠ¸

// ë§¤ì¥ ìƒì„¸ í˜ì´ì§€ (ë¦¬ë·°)
/*
// ----------------------------------------------------------------- //
  - title         : Store Detail Page (Review)
  - Description   :
  - Author        : gamseong
  - Created Date  : 2025.06.05
  - Last Modified : 2025.06.05
  - package       :

// ----------------------------------------------------------------- //
  [Changelog]
  - 2025.06.05 v1.0.0  :
// ----------------------------------------------------------------- //
*/import 'dart:convert';

import 'package:flutter/material.dart';
import 'package:get/get.dart';
import 'package:pick_caffeine_app/vm/gamseong/vm_store_update.dart';

class CustomerStoreReview extends StatelessWidget {
  CustomerStoreReview({super.key});

  final vm = Get.find<Vmgamseong>();

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: Column(
        crossAxisAlignment: CrossAxisAlignment.start,
        children: [
          Obx(() => Text('ì—ëŸ¬: ${vm.error.value}')), 
          Expanded(
            child: Obx(() {
              if (vm.myreviews.isEmpty) {
                return Center(child: Text('ì‘ì„±í•œ ë¦¬ë·°ê°€ ì—†ìŠµë‹ˆë‹¤.'));
              }
              return ListView.builder(
                itemCount: vm.myreviews.length,
                itemBuilder: (context, index) {
                  final review = vm.myreviews[index];
                  return Card(
                    child: ListTile(
                      leading: review['user_image'] != null
                          ? Image.memory(
                              base64Decode(review['user_image']),
                              width: 50,
                              height: 50,
                              fit: BoxFit.cover,
                            )
                          : Icon(Icons.person),
                      title: Text(review['user_nickname'] ?? ''),
                      subtitle: Column(
                        crossAxisAlignment: CrossAxisAlignment.start,
                        children: [
                          Text('ë‚´ìš©: ${review['review_content']}'),
                          Text('ì‘ì„±ì¼: ${review['review_date']}'),
                        ],
                      ),
                    ),
                  );
                },
              );
            }),
          ),
        ],
      ),
    );
  }
}

//---------------------------------------------- ì»¤ìŠ¤í…€ ìŠ¤í† ì–´ë¦¬ë·°
// // ë‚´ ì •ë³´ í˜ì´ì§€
// /*
// // ----------------------------------------------------------------- //
//   - title         : My Account Page
//   - Description   :
//   - Author        : Gam Seong
//   - Created Date  : 2025.06.05
//   - Last Modified : 2025.06.05
//   - package       :

// // ----------------------------------------------------------------- //
//   [Changelog]
//   - 2025.06.05 v1.0.0  :
// // ----------------------------------------------------------------- //
//* 
import 'dart:convert';

import 'package:flutter/material.dart';

import 'package:get/get.dart';
import 'package:get_storage/get_storage.dart';
import 'package:pick_caffeine_app/vm/gamseong/vm_store_update.dart';
import 'package:pick_caffeine_app/widget_class/utility/button_light_brown.dart';

class CustomerAccount extends StatelessWidget {
  CustomerAccount({super.key});
  final vm = Get.find<Vmgamseong>();
  final box = GetStorage();

  @override
  Widget build(BuildContext context) {
    WidgetsBinding.instance.addPostFrameCallback((_) {
      final id = box.read('loginId');
      if (id != null && vm.user.isEmpty) {
        vm.getInformation();
        vm.getMyReviews(id);
      }
    });

    return Scaffold(
      appBar: AppBar(title: Text('ë‚´ ì •ë³´ & ë¦¬ë·°')),
      body: Obx(() {
        if (vm.user.isEmpty) {
          return Center(child: CircularProgressIndicator());
        }

        final user = vm.user;

        return Column(
          children: [
            Row(
              children: [
                user['user_image'] != null && user['user_image'] != ''
                    ? ClipOval(
                        child: Image.memory(
                          base64Decode(user['user_image']),
                          width: 80,
                          height: 80,
                          fit: BoxFit.cover,
                        ),
                      )
                    : Icon(Icons.person, size: 80),
                ButtonLightBrown(
                  text: "ë‚´ì •ë³´ìˆ˜ì •",
                  onPressed: () => Get.to(() => CustomerAccount()),
                ),
                SizedBox(width: 20),
                Column(
                  crossAxisAlignment: CrossAxisAlignment.start,
                  children: [
                    Text("ğŸ‘¤ ë‹‰ë„¤ì„: ${user['user_nickname'] ?? ''}"),
                    Text("ğŸ“ ì—°ë½ì²˜: ${user['user_phone'] ?? ''}"),
                    Text("ğŸ“§ ì´ë©”ì¼: ${user['user_email'] ?? ''}"),
                  ],
                ),
              ],
            ),
            Expanded(
              child: Obx(() {
                if (vm.myreviews.isEmpty) {
                  return Center(child: Text("ì‘ì„±í•œ ë¦¬ë·°ê°€ ì—†ìŠµë‹ˆë‹¤."));
                }
                return ListView.builder(
                  itemCount: vm.myreviews.length,
                  itemBuilder: (context, index) {
                    final review = vm.myreviews[index];
                    return Card(
                      margin: EdgeInsets.all(10),
                      child: ListTile(
                        leading: review['user_image'] != null &&
                                review['user_image'] != ''
                            ? Image.memory(
                                base64Decode(review['user_image']),
                                width: 50,
                                height: 50,
                                fit: BoxFit.cover,
                              )
                            : Icon(Icons.person),
                        title: Text(review['user_nickname'] ?? ''),
                        subtitle: Column(
                          crossAxisAlignment: CrossAxisAlignment.start,
                          children: [
                            Text("ë‚´ìš©: ${review['review_content']}"),
                            Text("ì‘ì„±ì¼: ${review['review_date']}"),
                            Text("ìƒíƒœ: ${review['review_state']}"),
                          ],
                        ),
                      ),
                    );
                  },
                );
              }),
            ),
          ],
        );
      }),
    );
  }
}
//-- ì»¤ìŠ¤í…€ ì–´ì¹´ìš´íŠ¸----------------------------------------
